---
title: static和匿名namespace
date: 2018-04-17 22:17:31
tags: cpp
---

#### static的3种情况
1. 在函数内部的静态局部变量：在c++11之后，这种情况保证static局部变量构造的线程安全；静态局部变量作用域仅限于函数内部，但是可以保证只进行一次初始化，分配内存空间在堆上；初始化发生在调用时
2. 在class中的静态成员变量和静态全局变量：静态成员变量初始化时间和静态全局变量初始化时间相同，都发生在main函数之前；这两种静态变量作用域都是局部的，分别是类内和文件内，**静态全局变量在别的文件内可以访问**；因为在main函数之前进行的初始化，所以不能保证多个静态全局变量和静态成员变量的初始化顺序（无序，随机），用之需谨慎；
3. 静态成员方法和静态全局函数：**注意静态全局方法作用仅限于文件内部，其他模块的文件用不了**

#### 匿名namespace作用
因为在c++中static的作用太多，增加匿名namespace是为了可以在某些场合（定义一些仅在当前文件内部使用的变量和函数），避免使用static，直接使用匿名namespace使得语义清晰。